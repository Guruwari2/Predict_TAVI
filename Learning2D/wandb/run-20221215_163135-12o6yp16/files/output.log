
Epoch: 1
tensor([[[0.4756, 0.4822, 0.4853, 0.4795, 0.4821, 0.4784, 0.4847, 0.4782,
          0.4792, 0.4815, 0.4863, 0.4913, 0.4878, 0.4895, 0.4925, 0.4922,
          0.4875, 0.4881, 0.4871, 0.4820, 0.4843, 0.4836, 0.4879, 0.4902,
          0.4902, 0.4879, 0.4932, 0.4863, 0.4857, 0.4919, 0.4822, 0.4771,
          0.4848, 0.4758, 0.4767, 0.4731, 0.4729, 0.4860, 0.4836, 0.4815,
          0.4826, 0.4922, 0.4822, 0.4818, 0.4896, 0.4919, 0.4914, 0.4960,
          0.4953, 0.4891, 0.4898, 0.4868, 0.4854, 0.4848, 0.4884, 0.4905,
          0.4858, 0.4906, 0.4847, 0.4824, 0.4842, 0.4834, 0.4804, 0.4794,
          0.4794, 0.4853, 0.4831, 0.4904, 0.4935, 0.4987, 0.4931, 0.4787,
          0.4834, 0.4851, 0.4790, 0.4769, 0.4793, 0.4814, 0.4848, 0.4869,
          0.4840, 0.4873, 0.4798, 0.4747, 0.4778, 0.4847, 0.4878, 0.4824,
          0.4835, 0.4799, 0.4773, 0.4794, 0.4798, 0.4851, 0.4846, 0.4818,
          0.4748, 0.4782],
         [0.4836, 0.4781, 0.4833, 0.4870, 0.4931, 0.4879, 0.4861, 0.4825,
          0.4803, 0.4786, 0.4814, 0.4851, 0.4882, 0.4905, 0.4843, 0.4851,
          0.4879, 0.4862, 0.4846, 0.4898, 0.4899, 0.4883, 0.4937, 0.4882,
          0.4828, 0.4820, 0.4819, 0.4859, 0.4790, 0.4808, 0.4814, 0.4832,
          0.4866, 0.4821, 0.4871, 0.4804, 0.4844, 0.4795, 0.4795, 0.4838,
          0.4807, 0.4803, 0.4845, 0.4832, 0.4838, 0.4849, 0.4888, 0.4912,
          0.4931, 0.4895, 0.4861, 0.4809, 0.4825, 0.4836, 0.4839, 0.4851,
          0.4837, 0.4792, 0.4829, 0.4835, 0.4857, 0.4841, 0.4862, 0.4875,
          0.4857, 0.4892, 0.4861, 0.4884, 0.4902, 0.4912, 0.4853, 0.4869,
          0.4827, 0.4789, 0.4845, 0.4819, 0.4805, 0.4825, 0.4787, 0.4719,
          0.4806, 0.4826, 0.4747, 0.4629, 0.4698, 0.4772, 0.4788, 0.4782,
          0.4822, 0.4822, 0.4777, 0.4746, 0.4798, 0.4788, 0.4828, 0.4892,
          0.4889, 0.4882],
         [0.4757, 0.4774, 0.4843, 0.4833, 0.4888, 0.4894, 0.4928, 0.4878,
          0.4808, 0.4753, 0.4779, 0.4771, 0.4773, 0.4832, 0.4793, 0.4851,
          0.4756, 0.4707, 0.4781, 0.4874, 0.4852, 0.4779, 0.4769, 0.4778,
          0.4767, 0.4863, 0.4843, 0.4830, 0.4784, 0.4791, 0.4769, 0.4861,
          0.4868, 0.4865, 0.4863, 0.4888, 0.4844, 0.4863, 0.4844, 0.4767,
          0.4765, 0.4774, 0.4803, 0.4814, 0.4812, 0.4809, 0.4862, 0.4842,
          0.4829, 0.4817, 0.4821, 0.4781, 0.4800, 0.4786, 0.4894, 0.4899,
          0.4802, 0.4866, 0.4844, 0.4854, 0.4811, 0.4732, 0.4738, 0.4811,
          0.4787, 0.4811, 0.4805, 0.4863, 0.4786, 0.4827, 0.4859, 0.4867,
          0.4904, 0.4891, 0.4886, 0.4898, 0.4910, 0.4888, 0.4829, 0.4779,
          0.4787, 0.4838, 0.4824, 0.4795, 0.4820, 0.4743, 0.4789, 0.4876,
          0.4891, 0.4872, 0.4819, 0.4835, 0.4813, 0.4864, 0.4877, 0.4870,
          0.4801, 0.4780],
         [0.4856, 0.4807, 0.4836, 0.4838, 0.4726, 0.4679, 0.4739, 0.4772,
          0.4759, 0.4773, 0.4846, 0.4825, 0.4858, 0.4881, 0.4881, 0.4893,
          0.4850, 0.4884, 0.4829, 0.4834, 0.4894, 0.4853, 0.4851, 0.4826,
          0.4868, 0.4818, 0.4799, 0.4843, 0.4804, 0.4837, 0.4841, 0.4874,
          0.4832, 0.4788, 0.4837, 0.4892, 0.4859, 0.4860, 0.4865, 0.4846,
          0.4903, 0.4938, 0.4957, 0.4951, 0.4824, 0.4818, 0.4864, 0.4815,
          0.4795, 0.4776, 0.4770, 0.4832, 0.4911, 0.4901, 0.4889, 0.4898,
          0.4895, 0.4912, 0.4905, 0.4849, 0.4758, 0.4782, 0.4775, 0.4816,
          0.4839, 0.4890, 0.4901, 0.4890, 0.4887, 0.4901, 0.4892, 0.4760,
          0.4770, 0.4741, 0.4797, 0.4856, 0.4946, 0.4927, 0.4928, 0.4935,
          0.4883, 0.4827, 0.4833, 0.4862, 0.4843, 0.4867, 0.4870, 0.4859,
          0.4820, 0.4795, 0.4797, 0.4829, 0.4837, 0.4891, 0.4877, 0.4871,
          0.4833, 0.4812],
         [0.4757, 0.4755, 0.4850, 0.4832, 0.4817, 0.4841, 0.4820, 0.4830,
          0.4804, 0.4811, 0.4814, 0.4842, 0.4826, 0.4813, 0.4801, 0.4795,
          0.4834, 0.4830, 0.4852, 0.4868, 0.4874, 0.4790, 0.4794, 0.4856,
          0.4926, 0.4887, 0.4823, 0.4862, 0.4809, 0.4841, 0.4746, 0.4768,
          0.4785, 0.4780, 0.4748, 0.4801, 0.4837, 0.4789, 0.4779, 0.4766,
          0.4780, 0.4744, 0.4787, 0.4785, 0.4779, 0.4806, 0.4820, 0.4776,
          0.4809, 0.4812, 0.4817, 0.4855, 0.4801, 0.4804, 0.4764, 0.4843,
          0.4852, 0.4822, 0.4817, 0.4849, 0.4795, 0.4868, 0.4847, 0.4919,
          0.4947, 0.4873, 0.4818, 0.4861, 0.4873, 0.4854, 0.4892, 0.4894,
          0.4825, 0.4758, 0.4801, 0.4778, 0.4755, 0.4789, 0.4740, 0.4746,
          0.4816, 0.4774, 0.4754, 0.4726, 0.4823, 0.4742, 0.4714, 0.4749,
          0.4784, 0.4766, 0.4767, 0.4731, 0.4750, 0.4733, 0.4722, 0.4824,
          0.4861, 0.4852],
         [0.4865, 0.4838, 0.4811, 0.4864, 0.4892, 0.4860, 0.4904, 0.4804,
          0.4821, 0.4799, 0.4790, 0.4749, 0.4783, 0.4819, 0.4801, 0.4872,
          0.4878, 0.4789, 0.4823, 0.4766, 0.4845, 0.4816, 0.4813, 0.4814,
          0.4778, 0.4803, 0.4831, 0.4810, 0.4853, 0.4824, 0.4809, 0.4801,
          0.4856, 0.4943, 0.4847, 0.4907, 0.4833, 0.4765, 0.4737, 0.4770,
          0.4776, 0.4793, 0.4806, 0.4786, 0.4808, 0.4837, 0.4903, 0.4889,
          0.4901, 0.4795, 0.4808, 0.4805, 0.4836, 0.4830, 0.4874, 0.4928,
          0.4873, 0.4858, 0.4791, 0.4833, 0.4829, 0.4877, 0.4827, 0.4851,
          0.4849, 0.4866, 0.4853, 0.4840, 0.4774, 0.4817, 0.4820, 0.4803,
          0.4752, 0.4795, 0.4838, 0.4728, 0.4668, 0.4736, 0.4762, 0.4848,
          0.4842, 0.4879, 0.4873, 0.4800, 0.4841, 0.4822, 0.4866, 0.4884,
          0.4880, 0.4842, 0.4855, 0.4796, 0.4881, 0.4803, 0.4851, 0.4847,
          0.4844, 0.4849]]]) tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], device='cuda:0')
torch.Size([588])
Traceback (most recent call last):
  File "main.py", line 90, in <module>
    acc, auc, f1, val_loss = valid_func(model, loader_valid)
  File "/homes/n20darja/StageCesureCoeur/predict_tavi/Learning2D/train.py", line 88, in valid_func
    auc = roc_auc_score(gts,outputs)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/sklearn/metrics/_ranking.py", line 550, in roc_auc_score
    y_score = check_array(y_score, ensure_2d=False)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/sklearn/utils/validation.py", line 893, in check_array
    raise ValueError(
ValueError: Found array with dim 3. None expected <= 2.
Traceback (most recent call last):
  File "main.py", line 90, in <module>
    acc, auc, f1, val_loss = valid_func(model, loader_valid)
  File "/homes/n20darja/StageCesureCoeur/predict_tavi/Learning2D/train.py", line 88, in valid_func
    auc = roc_auc_score(gts,outputs)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/sklearn/metrics/_ranking.py", line 550, in roc_auc_score
    y_score = check_array(y_score, ensure_2d=False)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/sklearn/utils/validation.py", line 893, in check_array
    raise ValueError(
ValueError: Found array with dim 3. None expected <= 2.
tensor([0., 0., 0.,  ..., 1., 1., 1.])
tensor([[[0.4756, 0.4822, 0.4853,  ..., 0.4818, 0.4748, 0.4782],
         [0.4836, 0.4781, 0.4833,  ..., 0.4892, 0.4889, 0.4882],
         [0.4757, 0.4774, 0.4843,  ..., 0.4870, 0.4801, 0.4780],
         [0.4856, 0.4807, 0.4836,  ..., 0.4871, 0.4833, 0.4812],
         [0.4757, 0.4755, 0.4850,  ..., 0.4824, 0.4861, 0.4852],
         [0.4865, 0.4838, 0.4811,  ..., 0.4847, 0.4844, 0.4849]],
        [[0.4777, 0.4812, 0.4775,  ..., 0.4725, 0.4731, 0.4814],
         [0.4743, 0.4790, 0.4797,  ..., 0.4862, 0.4856, 0.4876],
         [0.4822, 0.4799, 0.4860,  ..., 0.4980, 0.4920, 0.4902],
         [0.4900, 0.4849, 0.4785,  ..., 0.4805, 0.4903, 0.4847],
         [0.4845, 0.4851, 0.4861,  ..., 0.4887, 0.4897, 0.4842],
         [0.4743, 0.4728, 0.4796,  ..., 0.4800, 0.4890, 0.4899]],
        [[0.4710, 0.4747, 0.4751,  ..., 0.4776, 0.4805, 0.4809],
         [0.4841, 0.4846, 0.4801,  ..., 0.4958, 0.4913, 0.4881],
         [0.4862, 0.4859, 0.4854,  ..., 0.4815, 0.4902, 0.4878],
         [0.4803, 0.4855, 0.4829,  ..., 0.4869, 0.4817, 0.4814],
         [0.4834, 0.4870, 0.4846,  ..., 0.4790, 0.4804, 0.4730],
         [0.4863, 0.4883, 0.4884,  ..., 0.4836, 0.4834, 0.4870]],
        ...,
        [[0.4809, 0.4836, 0.4790,  ..., 0.4855, 0.4895, 0.4910],
         [0.4785, 0.4792, 0.4797,  ..., 0.4870, 0.4845, 0.4869],
         [0.4839, 0.4831, 0.4857,  ..., 0.4791, 0.4841, 0.4863],
         [0.4739, 0.4784, 0.4839,  ..., 0.4765, 0.4815, 0.4851],
         [0.4808, 0.4854, 0.4841,  ..., 0.4839, 0.4865, 0.4835],
         [0.4882, 0.4887, 0.4873,  ..., 0.4860, 0.4826, 0.4838]],
        [[0.4835, 0.4811, 0.4848,  ..., 0.4932, 0.4909, 0.4962],
         [0.4796, 0.4793, 0.4834,  ..., 0.4812, 0.4825, 0.4899],
         [0.4775, 0.4787, 0.4798,  ..., 0.4856, 0.4831, 0.4859],
         [0.4791, 0.4760, 0.4770,  ..., 0.4826, 0.4862, 0.4892],
         [0.4782, 0.4791, 0.4861,  ..., 0.4825, 0.4895, 0.4856],
         [0.4777, 0.4780, 0.4781,  ..., 0.4859, 0.4873, 0.4868]],
        [[0.4765, 0.4828, 0.4799,  ..., 0.4765, 0.4803, 0.4811],
         [0.4846, 0.4850, 0.4824,  ..., 0.4903, 0.4927, 0.4901],
         [0.4853, 0.4784, 0.4794,  ..., 0.4812, 0.4905, 0.4915],
         [0.4772, 0.4789, 0.4790,  ..., 0.4878, 0.4917, 0.4914],
         [0.4860, 0.4786, 0.4766,  ..., 0.4845, 0.4851, 0.4871],
         [0.4800, 0.4866, 0.4800,  ..., 0.4809, 0.4794, 0.4817]]])