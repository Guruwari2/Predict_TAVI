
Epoch: 1
torch.Size([588, 512])
torch.Size([588, 1])
Traceback (most recent call last):
  File "main.py", line 87, in <module>
    train_loss = train_func(model, loader_train, optimizer, scaler)
  File "/homes/n20darja/StageCesureCoeur/predict_tavi/Learning2D/train.py", line 32, in train_func
    loss = criterion(logits, targets)
  File "/homes/n20darja/StageCesureCoeur/predict_tavi/Learning2D/train.py", line 16, in criterion
    norm = torch.ones(logits.view(-1).shape[0]).to(device)
NameError: name 'device' is not defined
Traceback (most recent call last):
  File "main.py", line 87, in <module>
    train_loss = train_func(model, loader_train, optimizer, scaler)
  File "/homes/n20darja/StageCesureCoeur/predict_tavi/Learning2D/train.py", line 32, in train_func
    loss = criterion(logits, targets)
  File "/homes/n20darja/StageCesureCoeur/predict_tavi/Learning2D/train.py", line 16, in criterion
    norm = torch.ones(logits.view(-1).shape[0]).to(device)
NameError: name 'device' is not defined