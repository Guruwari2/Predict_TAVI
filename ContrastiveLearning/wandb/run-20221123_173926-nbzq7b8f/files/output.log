
Epoch 1
Traceback (most recent call last):
  File "main.py", line 73, in <module>
    ssl_train_losses, model, last_checkpoint = train_scl(model, projector, train_loader, criterion, optimizer, scheduler, dict_config['n_epoch_proj'], use_wandb)
  File "/homes/n20darja/StageCesureCoeur/predict_tavi/ContrastiveLearning/scl.py", line 58, in train_scl
    train_loss = train_epoch_scl(encoder, projector, train_loader, criterion, optimizer, scheduler)
  File "/homes/n20darja/StageCesureCoeur/predict_tavi/ContrastiveLearning/scl.py", line 23, in train_epoch_scl
    image_aug1 = transform(image)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/transform.py", line 158, in __call__
    transformed = self.apply_transform(subject)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/augmentation/composition.py", line 51, in apply_transform
    subject = transform(subject)  # type: ignore[assignment]
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/transform.py", line 158, in __call__
    transformed = self.apply_transform(subject)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/augmentation/composition.py", line 113, in apply_transform
    transformed = transform(subject)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/transform.py", line 158, in __call__
    transformed = self.apply_transform(subject)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/augmentation/spatial/random_affine.py", line 179, in apply_transform
    transformed = transform(subject)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/transform.py", line 158, in __call__
    transformed = self.apply_transform(subject)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/augmentation/spatial/random_affine.py", line 362, in apply_transform
    sitk_image = nib_to_sitk(
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/data/io.py", line 304, in nib_to_sitk
    array = np.asarray(data)
  File "/opt/campux/virtualenv/deeplearning-u20-rtx-3080-pytorch-1.11/lib/python3.8/site-packages/torch/_tensor.py", line 732, in __array__
    return self.numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
Traceback (most recent call last):
  File "main.py", line 73, in <module>
    ssl_train_losses, model, last_checkpoint = train_scl(model, projector, train_loader, criterion, optimizer, scheduler, dict_config['n_epoch_proj'], use_wandb)
  File "/homes/n20darja/StageCesureCoeur/predict_tavi/ContrastiveLearning/scl.py", line 58, in train_scl
    train_loss = train_epoch_scl(encoder, projector, train_loader, criterion, optimizer, scheduler)
  File "/homes/n20darja/StageCesureCoeur/predict_tavi/ContrastiveLearning/scl.py", line 23, in train_epoch_scl
    image_aug1 = transform(image)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/transform.py", line 158, in __call__
    transformed = self.apply_transform(subject)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/augmentation/composition.py", line 51, in apply_transform
    subject = transform(subject)  # type: ignore[assignment]
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/transform.py", line 158, in __call__
    transformed = self.apply_transform(subject)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/augmentation/composition.py", line 113, in apply_transform
    transformed = transform(subject)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/transform.py", line 158, in __call__
    transformed = self.apply_transform(subject)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/augmentation/spatial/random_affine.py", line 179, in apply_transform
    transformed = transform(subject)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/transform.py", line 158, in __call__
    transformed = self.apply_transform(subject)
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/transforms/augmentation/spatial/random_affine.py", line 362, in apply_transform
    sitk_image = nib_to_sitk(
  File "/homes/n20darja/.local/lib/python3.8/site-packages/torchio/data/io.py", line 304, in nib_to_sitk
    array = np.asarray(data)
  File "/opt/campux/virtualenv/deeplearning-u20-rtx-3080-pytorch-1.11/lib/python3.8/site-packages/torch/_tensor.py", line 732, in __array__
    return self.numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.